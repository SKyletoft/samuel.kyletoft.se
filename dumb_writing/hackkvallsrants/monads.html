<!DOCTYPE html>
<html>
	<head>
		<title>Why Monads?</title>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
	</head>
	<body>

<h1>Why Monads?</h1>
<p>So, <i>monads</i> (UK: <i>Monn-add</i>, US: <i>Moe-nadd</i>) are a thing used kinda everywhere in
Functional Programming and beyond, even if people
don't know that what they're working with is a monad
once you leave the FP space.</p>

<h2>What is a monad?</h2>
<p>A monad is a container that can have a neutral (empty) state and a set
of operations on the things that maybe exist within it.</p>

<h2>What?</h2>
<p>Let's start with a list and function called <code>map</code>.</p>

<pre>
  myList = [1,2,3,4] :: [Int]
  someFunction = λx → x + 1 :: Int → Int

  $ map someFunction myList
  > [2,3,4,5]
</pre>

<p>Hopefully you've <code>seen</code> map before. Now consider a special list that can
at most take one element:</p>

<pre>
  data MaxOneList a
    = One a
    | Empty
</pre>

<p>Surely map should work on this list too.</p>
<pre>
  map :: (a → b) → MaxOneList a → MaxOneList b
  map _ Empty   = Empty
  map f (One x) = One (f x)
</pre>

<p>Now a list of max one element might seem like a dumb idea, but that's
essentially what a <code>Maybe</code> or an <code>Option</code> is.</p>

<pre>
  data MaxOneList a │ data Maybe a │ data Option
    = One a         │   = Just a   │   = Some a
    | Empty         │   | Nothing  │   | None
</pre>

<p>So clearly map is a function that should operate over a greater set of
types than just the simple list. In the haskell world we call this set
of types Functors and the interface is just that simple.</p>

<pre>
  class Functor container where
    fmap :: (a → b) → container a → container b
</pre>

<p>Now we can write code that is generic over any container that has a
reasonable implementation of <code>map</code>.</p>

<p>Now, skipping over some details (Applicative) the other two
important interfaces are return and bind (also
called <code>and_then</code>).</p>

<pre>
  class Monad container where
    return :: a → container a
    bind   :: container a → (a → container b) → container b
</pre>

<p>(<code>Bind</code> is usually spelled <code>>>=</code>.)</p>
<p><code>Return</code> just wraps the element in the container.</p>

<pre>
  $ return x :: Maybe a
  > Just x

  $ return x :: [a]
  > [x]
</pre>

<p><code>Bind</code> however is the more interesting part. In the case
of <code>Maybe</code> you might and an element and you have a function
that might give you a result.</p>

<pre>
  $ bind (Just 2) (λx → Just (x + 1))
  > Just 3
</pre>

<p><code>Bind</code> is essentially just a flattened <code>fmap</code>.</p>

<pre>
  flatten :: Maybe (Maybe a) → Maybe a
  flatten (Just (Just x) = Just x
  flatten _              = Nothing

  bind :: Maybe a → (a → Maybe b) → Maybe b
  bind Nothing _  = Nothing
  bind (Just x) f = f x

  <=>

  bind x f = flatten (fmap f x)
</pre>

For lists flatten is called <code>concat</code> and works like this:
<pre>
  $ concat [[1, 2], [3], [4], [5, 6, 7]
  > [1, 2, 3, 4, 5, 6, 7]
</pre>

<p>You might've seen <code>flatMap</code> or <code>concatMap</code>. They're <code>bind</code>!</p>

<p>And that's all a monad is, a generic interface with these operations.</p>

<h2>So, why?</h2>

<h2>Sidestory: Applicative</h2>

Next we have another interface that builds upon Functor called
Applicative. It's similar to (f)map but we also keep the function in
the container and has a way to wrap an element in a container.

<pre>
  class Functor container => Applicative container where
    pure :: a → container a
    <*>  :: container (a → b) → container a → container b
</pre>

It using it looks like this:

<pre>
  f = λx → x + 1

  $ pure x
  > Just x

  $ pure f <*> pure 1 :: Maybe Int
  > Just 2

  $ Nothing <*> Just 1
  > Nothing

  $ Just f <*> Nothing
  > Nothing

  $ [f, g] <*> [x, y]
  > [f x, f y, g x, g y]
</pre>


		<!-- https://thebestmotherfucking.website/main.css -->
		<style> body{font-family:Open Sans,Arial;color:#454545;font-size:16px;margin:2em auto;max-width:800px;padding:1em;line-height:1.4;-webkit-hyphens:auto;-ms-hyphens:auto;hyphens:auto}html.contrast body{color:#050505}html.contrast blockquote{color:#11151a}html.contrast blockquote:before{color:#262626}html.contrast a{color:#03f}html.contrast a:visited{color:#7d013e}html.contrast span.wr{color:#800}html.contrast span.mfw{color:#4d0000}@media screen and (prefers-color-scheme:light){html.inverted{background-color:#000}html.inverted body{color:#d9d9d9}html.inverted #contrast,html.inverted #invmode{color:#fff;background-color:#000}html.inverted blockquote{color:#d3c9be}html.inverted blockquote:before{color:#b8b8b8}html.inverted a{color:#00a2e7}html.inverted a:visited{color:#ca1a70}html.inverted span.wr{color:#d24637}html.inverted span.mfw{color:#b00000}html.inverted.contrast{background-color:#000}html.inverted.contrast body{color:#fff}html.inverted.contrast #contrast,html.inverted.contrast #invmode{color:#fff;background-color:#000}html.inverted.contrast blockquote{color:#f8f6f5}html.inverted.contrast blockquote:before{color:#e5e5e5}html.inverted.contrast a{color:#44c7ff}html.inverted.contrast a:visited{color:#e9579e}html.inverted.contrast span.wr{color:#db695d}html.inverted.contrast span.mfw{color:#ff0d0d}}@media (prefers-color-scheme:dark){html:not(.inverted){background-color:#000}html:not(.inverted) body{color:#d9d9d9}html:not(.inverted) #contrast,html:not(.inverted) #invmode{color:#fff;background-color:#000}html:not(.inverted) blockquote{color:#d3c9be}html:not(.inverted) blockquote:before{color:#b8b8b8}html:not(.inverted) a{color:#00a2e7}html:not(.inverted) a:visited{color:#ca1a70}html:not(.inverted) span.wr{color:#d24637}html:not(.inverted) span.mfw{color:#b00000}html:not(.inverted).contrast{background-color:#000}html:not(.inverted).contrast body{color:#fff}html:not(.inverted).contrast #contrast,html:not(.inverted).contrast #invmode{color:#fff;background-color:#000}html:not(.inverted).contrast blockquote{color:#f8f6f5}html:not(.inverted).contrast blockquote:before{color:#e5e5e5}html:not(.inverted).contrast a{color:#44c7ff}html:not(.inverted).contrast a:visited{color:#e9579e}html:not(.inverted).contrast span.wr{color:#db695d}html:not(.inverted).contrast span.mfw{color:#ff0d0d}html.inverted html{background-color:#fefefe}}a{color:#07a}a:visited{color:#941352}.noselect{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}span.citneed{vertical-align:top;font-size:.7em;padding-left:.3em}small{font-size:.4em}p.st{margin-top:-1em}div.fancyPositioning div.picture-left{float:left;width:40%;overflow:hidden;margin-right:1em}div.fancyPositioning div.picture-left img{width:100%}div.fancyPositioning div.picture-left figure{margin:10px}div.fancyPositioning div.picture-left figure figcaption{font-size:.7em}div.fancyPositioning div.tleft{float:left;width:55%}div.fancyPositioning div.tleft p:first-child{margin-top:0}div.fancyPositioning:after{display:block;content:"";clear:both}ul li img{height:1em}blockquote{color:#456;margin-left:0;margin-top:2em;margin-bottom:2em}blockquote span{float:left;margin-left:1rem;padding-top:1rem}blockquote author{display:block;clear:both;font-size:.6em;margin-left:2.4rem;font-style:oblique}blockquote author:before{content:"- ";margin-right:1em}blockquote:before{font-family:Times New Roman,Times,Arial;color:#666;content:open-quote;font-size:2.2em;font-weight:600;float:left;margin-top:0;margin-right:.2rem;width:1.2rem}blockquote:after{content:"";display:block;clear:both}@media screen and (max-width:500px){body{text-align:left}div.fancyPositioning div.picture-left,div.fancyPositioning div.tleft{float:none;width:inherit}blockquote span{width:80%}blockquote author{padding-top:1em;width:80%;margin-left:15%}blockquote author:before{content:"";margin-right:inherit}}span.visited{color:#941352}span.visited-maroon{color:#85144b}span.wr{color:#c0392b;font-weight:600}button.cont-inv,span.wr{text-decoration:underline}button.cont-inv{cursor:pointer;border-radius:2px;position:fixed;right:10px;font-size:.8em;border:0;padding:2px 5px}#contrast{color:#000;top:10px}#contrast,#invmode{-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#invmode{color:#fff;background-color:#000;position:fixed;top:34px;text-decoration:underline}@media screen and (max-width:1080px){#contrast,#invmode{position:absolute}}span.sb{color:#00e}span.sb,span.sv{cursor:not-allowed}span.sv{color:#551a8b}span.foufoufou{color:#444;font-weight:700}span.foufoufou:before{content:"";display:inline-block;width:1em;height:1em;margin-left:.2em;margin-right:.2em;background-color:#444}span.foufivfoufivfoufiv{color:#454545;font-weight:700}span.foufivfoufivfoufiv:before{content:"";display:inline-block;width:1em;height:1em;margin-left:.2em;margin-right:.2em;background-color:#454545}span.mfw{color:#730000}a.kopimi,a.kopimi img.kopimi{display:block;margin-left:auto;margin-right:auto}a.kopimi img.kopimi{height:2em}p.fakepre{font-family:monospace;font-size:.9em} </style>
		<style>
			code, pre {
				background-color: #F0F0F0;
				border-radius: 5px;
			}
		</style>
	</body>
</html>
